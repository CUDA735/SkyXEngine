
#include <../struct.h>

sampler2D BaseCloudsTexture: register(s0);
sampler2D SecondCloudsTexture: register(s1);

float2 BlendFactorBias;
float4 Color;
float Alpha;

float4 main(vs_out_skyclouds IN):COLOR0
{
	float dist = (1.0f)-distance(IN.TexUV,float2(1,1));
	IN.TexUV.x += BlendFactorBias.y;
	
	float4 Color1 = tex2D(BaseCloudsTexture, IN.TexUV);
	float4 Color2 = tex2D(SecondCloudsTexture, IN.TexUV);
	float4 FinalColor = lerp(Color1,Color2,BlendFactorBias.x);
	dist *= 1.f + dist;
	FinalColor.a *= saturate(dist);
	#ifndef SHADOW
	FinalColor.rgb = lerp(FinalColor.rgb,Color.rgb,Color.a);
	#endif
	FinalColor.a *= Alpha;

	#ifdef SHADOW
	return FinalColor.a;
	#else
	return FinalColor;
	#endif
}
